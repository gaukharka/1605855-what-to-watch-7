(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{68:function(e,t,c){"use strict";c.r(t);var a,n,r=c(1),i=c.n(r),s=c(21),l=c.n(s),o=c(2),d=c(6),j=c(15),u=c(11),b="/",m="/login",h="/mylist",O="/films/:id",f="/films/:id/review",v="/player/:id",x="All genres",_="AUTH",g="NO_AUTH",p="UNKNOWN",N="/films",w="/promo",y="/favorite",k="/comments",R="/login",M="/logout",C=50,F=401,S="Bad",q="Normal",E="Good",I="Very good",H="Awesome",L="films/changeGenre",B="films/reset",V="films/resetGenre",T="films/resetMaxMoviesShown",A="data/loadMovies",D="data/loadReviews",W="data/loadPromoMovie",P="data/loadFavoriteMovie",z="data/loadSimilarMovies",U="user/requireAuthorization",Z="user/logout",G="films/redirectToRoute",J="data/error",K="data/fetchingStatus",X="data/loadMovie",Q="data/updateMovie",Y="data/postReview",$=Object(d.b)(L,(function(e){return{payload:e}})),ee=Object(d.b)(B),te=Object(d.b)(A,(function(e){return{payload:e}})),ce=Object(d.b)(W,(function(e){return{payload:e}})),ae=Object(d.b)(P,(function(e){return{payload:e}})),ne=Object(d.b)(D,(function(e){return{payload:e}})),re=Object(d.b)(U,(function(e,t){return{payload:{authStatus:e,authInfo:t}}})),ie=Object(d.b)(Z),se=Object(d.b)(G,(function(e){return{payload:e}})),le=Object(d.b)(J,(function(e){return{payload:e}})),oe=Object(d.b)(K,(function(e){return{payload:e}})),de=Object(d.b)(Q,(function(e){return{payload:e}})),je=Object(d.b)(Q,(function(e){return{payload:e}})),ue=Object(d.b)(Y,(function(e){return{payload:e}})),be=Object(d.b)(V),me=Object(d.b)(T),he=Object(d.b)(z,(function(e){return{payload:e}})),Oe=Object(d.b)(X,(function(e){return{payload:e}})),fe={authorizationStatus:p,authInfo:{}},ve=Object(d.c)(fe,(function(e){e.addCase(re,(function(e,t){e.authorizationStatus=t.payload.authStatus,e.authInfo=t.payload.authInfo})).addCase(ie,(function(e){e.authorizationStatus=g,e.authInfo={}}))})),xe={genre:x,movies:[],promoMovie:{},movie:{},favoriteMovies:[],isFetching:!1,error:"",maxMoviesShown:8,similarMovies:[]},_e=Object(d.c)(xe,(function(e){e.addCase(te,(function(e,t){e.movies=t.payload})).addCase(Oe,(function(e,t){e.movie=t.payload})).addCase(ce,(function(e,t){e.promoMovie=t.payload})).addCase(ae,(function(e,t){e.favoriteMovies=t.payload})).addCase($,(function(e,t){e.genre=t.payload})).addCase(ee).addCase(oe,(function(e,t){e.isFetching=t.payload})).addCase(de,(function(e,t){e.movie=t.payload,e.promoMovie=t.payload})).addCase(be,(function(e){e.genre=x})).addCase(me,(function(e){e.maxMoviesShown=8})).addCase(he,(function(e,t){e.similarMovies=t.payload}))})),ge=Object(d.c)({reviews:[]},(function(e){e.addCase(ne,(function(e,t){e.reviews=t.payload}))})),pe="USER",Ne="MOVIE",we="REVIEW",ye=Object(u.c)((a={},Object(j.a)(a,Ne,_e),Object(j.a)(a,pe,ve),Object(j.a)(a,we,ge),a)),ke=c(37),Re=c.n(ke),Me=401,Ce=null!==(n=localStorage.getItem("token"))&&void 0!==n?n:"",Fe=c(9),Se=Object(Fe.a)(),qe=function(e){return function(e){return function(t){return t.type===G&&Se.push(t.payload),e(t)}}},Ee=c(4),Ie=function(e){var t=Math.floor(e/3600),c=Math.floor(e%3600/60),a=Math.round(e%60),n="".concat(c>9?Math.max(c,0):"0".concat(Math.max(0,c)),":").concat(a>9?Math.max(0,a):"0".concat(Math.max(0,a))),r="".concat(t>9?Math.max(t,0):"0".concat(Math.max(0,t)),":").concat(n);return t<1?n:r},He=c(14),Le=c(3),Be=c.n(Le),Ve=(Be.a.shape({id:Be.a.number.isRequired,name:Be.a.string.isRequired,posterImage:Be.a.string.isRequired,previewImage:Be.a.string.isRequired,backgroundImage:Be.a.string.isRequired,backgroundColor:Be.a.string.isRequired,videoLink:Be.a.string.isRequired,previewVideo:Be.a.string.isRequired,description:Be.a.string.isRequired,rating:Be.a.number.isRequired,scoresCount:Be.a.number.isRequired,director:Be.a.string.isRequired,starring:Be.a.array.isRequired,runTime:Be.a.number.isRequired,genre:Be.a.string.isRequired,released:Be.a.number.isRequired,isFavorite:Be.a.bool.isRequired}),c(7)),Te=c(0);var Ae=function(e){var t=e.previewImage,c=e.previewVideo,a=e.isActive,n=Object(r.useRef)(null);return Object(r.useEffect)((function(){var e;return a?e=setTimeout((function(){return n.current.play()}),1e3):n.current.pause(),function(){return clearTimeout(e)}}),[a]),Object(Te.jsx)("div",{className:"small-film-card__image",children:Object(Te.jsx)("video",{muted:!0,height:"175",type:"video/mp4",src:c,poster:t,ref:n})})};var De=function(e){var t=e.movie,c=e.onMouseOver,a=e.onMouseOut,n=e.isActive,r=t.id,i=t.name,s=t.previewImage,l=t.previewVideo;return Object(Te.jsxs)("article",{className:"small-film-card catalog__films-card",onMouseOver:c,onMouseOut:a,children:[n?Object(Te.jsx)(Ae,{previewImage:s,previewVideo:l,isActive:n}):Object(Te.jsx)("img",{src:s,alt:i,width:"280",height:"175"}),Object(Te.jsx)("h3",{className:"small-film-card__title",children:Object(Te.jsx)(Ve.a,{to:"/films/".concat(r),className:"small-film-card__link",children:i})})]})};var We=function(e){var t=e.onClickShowMoreMovies;return Object(Te.jsx)("div",{className:"catalog__more",children:Object(Te.jsx)("button",{className:"catalog__button",type:"button",onClick:function(){return t()},children:"Show more"})})},Pe=function(e){return e[Ne].isFetching},ze=function(e){return e[Ne].movies},Ue=function(e){return e[Ne].genre},Ze=function(e){return e[Ne].promoMovie},Ge=function(e){return e[Ne].movie},Je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t===x?e:e.filter((function(e){return e.genre===t}))};var Ke=function(e){var t=e.movies,c=Object(o.d)(Ue),a=Object(r.useState)(),n=Object(He.a)(a,2),i=n[0],s=n[1],l=Object(r.useState)(8),d=Object(He.a)(l,2),j=d[0],u=d[1],b=Je(t,c);return Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)("div",{className:"catalog__films-list","data-testid":"catalog-films-list",children:b.slice(0,j).map((function(e){return Object(Te.jsx)(De,{movie:e,isActive:e===i,onMouseOver:function(){return s(e)},onMouseOut:function(){return s(null)}},e.id+1)}))}),j<b.length&&Object(Te.jsx)(We,{onClickShowMoreMovies:function(){u(j+8)}})]})};var Xe=function(e){var t=e.isFooter,c=Object(o.c)();return Object(Te.jsx)("div",{className:"logo","data-testid":"app-logo",children:Object(Te.jsxs)(Ve.a,{to:b,className:"logo__link ".concat(t?"logo__link--light":""),onClick:function(){return c(be())},children:[Object(Te.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(Te.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(Te.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})})};var Qe=function(){return Object(Te.jsxs)("footer",{className:"page-footer","data-testid":"footer",children:[Object(Te.jsx)(Xe,{isFooter:!0}),Object(Te.jsx)("div",{className:"copyright",children:Object(Te.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})},Ye=c(20);var $e=function(){var e=Object(o.d)(ze),t=Object(o.d)(Ue),c=Object(Ye.a)(new Set([x].concat(Object(Ye.a)(e.map((function(e){return e.genre})))))),a=Object(o.c)();return Object(Te.jsx)("ul",{className:"catalog__genres-list",children:c.map((function(e,c){var n=c+1;return Object(Te.jsx)("li",{className:"catalog__genres-item ".concat(e===t?"catalog__genres-item--active":""),onClick:function(){return a($(e))},children:Object(Te.jsx)(Ve.a,{to:"/#",className:"catalog__genres-link",children:e})},n)}))})},et=c(19),tt=function(e){return{id:e.id,name:e.name,posterImage:e.poster_image,previewImage:e.preview_image,backgroundImage:e.background_image,backgroundColor:e.background_color,videoLink:e.video_link,previewVideo:e.preview_video_link,description:e.description,rating:e.rating,scoresCount:e.scores_count,director:e.director,starring:e.starring,runTime:e.run_time,genre:e.genre,released:e.released,isFavorite:e.is_favorite}},ct=function(e){return e.map((function(e){return tt(e)}))},at=function(){return function(e,t,c){return c.get(N).then((function(t){var c=t.data;return e(te(ct(c)))})).catch((function(t){return e(le(t.message))}))}},nt=function(){return function(e,t,c){return c.get(w).then((function(t){var c=t.data;return e(ce(tt(c)))})).catch((function(t){return e(le(t.message))}))}},rt=function(){return function(e,t,c){return c.get(y).then((function(t){var c=t.data;return e(ae(ct(c)))})).catch((function(t){return e(le(t.message))}))}},it=function(e){return function(t,c,a){return a.get("".concat(k,"/").concat(e)).then((function(e){var c=e.data;return t(ne(c))})).catch((function(e){return t(le(e.message))}))}},st=function(e){return oe(e)},lt=function(e){return e[pe].authorizationStatus};var ot=function(){var e=Object(o.d)(lt),t=Object(o.c)(),c=Object(Ee.g)();return Object(Te.jsx)("ul",{className:"user-block","data-testid":"app-user-block",children:e===_?Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)("li",{className:"user-block__item",children:Object(Te.jsx)("div",{className:"user-block__avatar",onClick:function(){return c.push("".concat(h))},children:Object(Te.jsx)("img",{src:"img/avatar.jpg",alt:"User avatar",width:"63",height:"63"})})}),Object(Te.jsx)("li",{className:"user-block__item",children:Object(Te.jsx)(Ve.a,{to:b,className:"user-block__link",onClick:function(e){e.preventDefault(),t((function(e,t,c){return c.delete(M).then((function(){return localStorage.removeItem("token")})).then((function(){return e(ie())}))}))},children:"Sign out"})})]}):Object(Te.jsx)(Ve.a,{to:m,className:"user-block__link",children:"Sign in"})})};var dt=function(e){var t=e.onClick;return Object(Te.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:t,"data-testid":"button-play",children:[Object(Te.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(Te.jsx)("use",{xlinkHref:"#play-s"})}),Object(Te.jsx)("span",{children:"Play"})]})};var jt=function(e){var t=e.movie,c=Object(o.c)(),a=function(){c(nt()),c(at()),c(rt())},n=Object(Ee.g)(),r=Object(o.d)(lt),i=function(){return n.push("".concat(m))},s=function(){var e,n;1!==t.id&&(c((e=t.id,n=t.isFavorite?0:1,function(t,c,a){return a.post("".concat(y,"/").concat(e,"/").concat(n)).then((function(e){var c=e.data;return t(je(tt(c)))})).catch((function(e){return t(le(e.message))}))})),a()),c(function(e,t){return function(c,a,n){return n.post("".concat(y,"/").concat(e,"/").concat(t)).then((function(e){var t=e.data;return c(de(tt(t)))})).catch((function(e){return c(le(e.message))}))}}(t.id,t.isFavorite?0:1)),a()};return Object(Te.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:r===_?s:i,"data-testid":"button-mylist",children:[t.isFavorite?Object(Te.jsx)("svg",{viewBox:"0 0 18 14",width:"18",height:"14",children:Object(Te.jsx)("use",{xlinkHref:"#in-list"})}):Object(Te.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(Te.jsx)("use",{xlinkHref:"#add"})}),Object(Te.jsx)("span",{children:"My list"})]})};var ut=function(){return Object(Te.jsx)("div",{className:"visually-hidden",children:Object(Te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[Object(Te.jsxs)("symbol",{id:"add",viewBox:"0 0 19 20",children:[Object(Te.jsx)("title",{children:"+"}),Object(Te.jsx)("desc",{children:"Created with Sketch."}),Object(Te.jsx)("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:Object(Te.jsx)("polygon",{id:"+",fill:"#EEE5B5",points:"10.777832 11.2880859 10.777832 19.5527344 8.41650391 19.5527344 8.41650391 11.2880859 0.627929688 11.2880859 0.627929688 8.92675781 8.41650391 8.92675781 8.41650391 0.662109375 10.777832 0.662109375 10.777832 8.92675781 18.5664062 8.92675781 18.5664062 11.2880859"})})]}),Object(Te.jsxs)("symbol",{id:"full-screen",viewBox:"0 0 27 27",children:[Object(Te.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.8571 0H16V3.14286H23.8571V11H27V3.14286V0H23.8571Z",fill:"#FFF9D9",fillOpacity:"0.7"}),Object(Te.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27 23.8571V16H23.8571V23.8571H16V27H23.8571H27L27 23.8571Z",fill:"#FFF9D9",fillOpacity:"0.7"}),Object(Te.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 3.14286L0 11H3.14286L3.14286 3.14286L11 3.14286V0H3.14286H0L0 3.14286Z",fill:"#FFF9D9",fillOpacity:"0.7"}),Object(Te.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.14286 27H11V23.8571H3.14286L3.14286 16H0L0 23.8571V27H3.14286Z",fill:"#FFF9D9",fillOpacity:"0.7"})]}),Object(Te.jsx)("symbol",{id:"in-list",viewBox:"0 0 18 14",children:Object(Te.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.40513 5.35353L6.1818 8.90902L15.5807 0L18 2.80485L6.18935 14L0 8.17346L2.40513 5.35353Z",fill:"#EEE5B5"})}),Object(Te.jsxs)("symbol",{id:"pause",viewBox:"0 0 14 21",children:[Object(Te.jsx)("symbol",{id:"play-s",viewBox:"0 0 19 19",children:Object(Te.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 0L19 9.5L0 19V0Z",fill:"#EEE5B5"})}),Object(Te.jsx)("title",{children:"Artboard"}),Object(Te.jsx)("desc",{children:"Created with Sketch."}),Object(Te.jsxs)("g",{id:"Artboard",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:[Object(Te.jsx)("polygon",{id:"Line",fill:"#EEE5B5",fillRule:"nonzero",points:"0 -1.11910481e-13 4 -1.11910481e-13 4 21 0 21"}),Object(Te.jsx)("polygon",{id:"Line",fill:"#EEE5B5",fillRule:"nonzero",points:"10 -1.11910481e-13 14 -1.11910481e-13 14 21 10 21"})]})]})]})})};var bt=function(){var e=Object(o.d)(Ze),t=Object(o.d)(ze),c=e.id,a=e.name,n=e.genre,r=e.released,i=e.posterImage,s=e.backgroundImage,l=Object(Ee.g)();return Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)(ut,{}),Object(Te.jsxs)("section",{className:"film-card",children:[Object(Te.jsx)("div",{className:"film-card__bg",children:Object(Te.jsx)("img",{src:s,alt:a})}),Object(Te.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(Te.jsxs)("header",{className:"page-header film-card__head",children:[Object(Te.jsx)(Xe,{}),Object(Te.jsx)(ot,{})]}),Object(Te.jsx)("div",{className:"film-card__wrap",children:Object(Te.jsxs)("div",{className:"film-card__info",children:[Object(Te.jsx)("div",{className:"film-card__poster",children:Object(Te.jsx)("img",{src:i,alt:a,width:"218",height:"327"})}),Object(Te.jsxs)("div",{className:"film-card__desc",children:[Object(Te.jsx)("h2",{className:"film-card__title",children:a}),Object(Te.jsxs)("p",{className:"film-card__meta",children:[Object(Te.jsx)("span",{className:"film-card__genre",children:n}),Object(Te.jsx)("span",{className:"film-card__year",children:r})]}),Object(Te.jsxs)("div",{className:"film-card__buttons",children:[Object(Te.jsx)(dt,{onClick:function(){return l.push("/player/".concat(c))}}),Object(Te.jsx)(jt,{movie:e})]})]})]})})]}),Object(Te.jsxs)("div",{className:"page-content",children:[Object(Te.jsxs)("section",{className:"catalog",children:[Object(Te.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(Te.jsx)($e,{}),Object(Te.jsx)(Ke,{movies:t})]}),Object(Te.jsx)(Qe,{})]})]})};var mt=function(){var e=Object(o.c)(),t=Object(r.useRef)(),c=Object(r.useRef)();return Object(Te.jsxs)("div",{className:"user-page",children:[Object(Te.jsxs)("header",{className:"page-header user-page__head",children:[Object(Te.jsx)(Xe,{}),Object(Te.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"})]}),Object(Te.jsx)("div",{className:"sign-in user-page__content",children:Object(Te.jsxs)("form",{action:"#",className:"sign-in__form",onSubmit:function(a){a.preventDefault(),e(function(e){var t=e.login,c=e.password;return function(e,a,n){return n.post(R,{email:t,password:c}).then((function(e){var t=e.data;return localStorage.setItem("token",t.token)})).then((function(){return e(re(_))})).then((function(){return e(se(b))})).catch((function(t){return e(le(t.message))}))}}({login:t.current.value,password:c.current.value}))},children:[Object(Te.jsxs)("div",{className:"sign-in__fields",children:[Object(Te.jsxs)("div",{className:"sign-in__field",children:[Object(Te.jsx)("input",{ref:t,className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email","data-testid":"email"}),Object(Te.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(Te.jsxs)("div",{className:"sign-in__field",children:[Object(Te.jsx)("input",{ref:c,className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password","data-testid":"password"}),Object(Te.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(Te.jsx)("div",{className:"sign-in__submit",children:Object(Te.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(Te.jsx)(Qe,{})]})};var ht=function(){var e,t=Object(o.d)(Ge),c=t.rating,a=t.scoresCount,n=t.description,r=t.director,i=t.starring;return Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsxs)("div",{className:"film-rating",children:[Object(Te.jsx)("div",{className:"film-rating__score",children:c}),Object(Te.jsxs)("p",{className:"film-rating__meta",children:[Object(Te.jsx)("span",{className:"film-rating__level",children:(e=c,e>=0&e<3?S:e>=3&&e<5?q:e>=5&&e<8?E:e>=8&&e<10?I:H)}),Object(Te.jsxs)("span",{className:"film-rating__count",children:[a," ratings"]})]})]}),Object(Te.jsxs)("div",{className:"film-card__text",children:[Object(Te.jsx)("p",{children:"Description"}),Object(Te.jsx)("p",{children:n}),Object(Te.jsx)("p",{className:"film-card__director",children:Object(Te.jsxs)("strong",{children:["Director: ",r]})}),Object(Te.jsx)("p",{className:"film-card__starring",children:Object(Te.jsxs)("strong",{children:["Starring: ",i]})})]})]})};var Ot=function(e){var t=e.data,c=e.title;return Object(Te.jsxs)("p",{className:"film-card__details-item",children:[Object(Te.jsx)("strong",{className:"film-card__details-name",children:c}),Object(Te.jsx)("span",{className:"film-card__details-value",children:t})]})};var ft=function(e){var t=e.movie,c="Director",a="Starring",n="Run Time",r="Genre",i="Released";return Object(Te.jsxs)("div",{className:"film-card__text film-card__row",children:[Object(Te.jsxs)("div",{className:"film-card__text-col",children:[Object(Te.jsx)(Ot,{data:t.director,title:c}),Object(Te.jsx)(Ot,{data:t.starring.length>1?t.starring.reduce((function(e,t){return[e,", ",t]})):t.starring,title:a})]}),Object(Te.jsxs)("div",{className:"film-card__text-col",children:[Object(Te.jsx)(Ot,{data:t.runTime,title:n}),Object(Te.jsx)(Ot,{data:t.genre,title:r}),Object(Te.jsx)(Ot,{data:t.released,title:i})]})]})},vt=c(16),xt=c.n(vt),_t=c(24),gt=function(e){return e[we].reviews},pt=c(38),Nt=c.n(pt);Be.a.shape({id:Be.a.number.isRequired,user:Be.a.shape({id:Be.a.number.isRequired,name:Be.a.string.isRequired}).isRequired,rating:Be.a.number.isRequired,comment:Be.a.string.isRequired,date:Be.a.string.isRequired});var wt=function(e){var t=e.review;return Object(Te.jsxs)("div",{className:"review",children:[Object(Te.jsxs)("blockquote",{className:"review__quote",children:[Object(Te.jsx)("p",{className:"review__text",children:t.comment}),Object(Te.jsxs)("footer",{className:"review__details",children:[Object(Te.jsx)("cite",{className:"review__author",children:t.user.name}),Object(Te.jsx)("time",{className:"review__date",dateTime:"2016-12-24",children:Nt()(t.date,"yyyy-mm-dd")})]})]}),Object(Te.jsx)("div",{className:"review__rating",children:t.rating})]})};var yt=function(e){var t=e.id,c=Object(o.d)(gt),a=Object(o.c)();return Object(r.useEffect)((function(){Object(_t.a)(xt.a.mark((function e(){return xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a(it(t)));case 1:case"end":return e.stop()}}),e)})))()}),[]),Object(Te.jsx)("div",{className:"film-card__reviews film-card__row",children:Object(Te.jsx)("div",{className:"film-card__reviews-col",children:c.map((function(e){return Object(Te.jsx)(wt,{review:e},e.id+1)}))})})};var kt=function(){var e=Object(o.d)(Ge),t=Object(r.useState)(1),c=Object(He.a)(t,2),a=c[0],n=c[1];return Object(Te.jsxs)("div",{className:"film-card__desc","data-testid":"tabs",children:[Object(Te.jsx)("nav",{className:"film-nav film-card__nav",children:Object(Te.jsxs)("ul",{className:"film-nav__list",children:[Object(Te.jsx)("li",{className:1===a?"film-nav__item film-nav__item--active":"film-nav__item",children:Object(Te.jsx)("a",{href:"/#",className:"film-nav__link",onClick:function(e){e.preventDefault(),n(1)},children:"Overview"})}),Object(Te.jsx)("li",{className:2===a?"film-nav__item film-nav__item--active":"film-nav__item",children:Object(Te.jsx)("a",{href:"/#",className:"film-nav__link",onClick:function(e){e.preventDefault(),n(2)},children:"Details"})}),Object(Te.jsx)("li",{className:3===a?"film-nav__item film-nav__item--active":"film-nav__item",children:Object(Te.jsx)("a",{href:"/#",className:"film-nav__link",onClick:function(e){e.preventDefault(),n(3)},children:"Reviews"})})]})}),1===a?Object(Te.jsx)(ht,{}):"",2===a?Object(Te.jsx)(ft,{movie:e}):"",3===a?Object(Te.jsx)(yt,{id:e.id}):""]})};var Rt=function(){var e=Object(o.d)(Ge),t=Object(o.d)(ze),c=Object(o.d)(Ue),a=Je(t,c).filter((function(t){return t.id!==e.id})).filter((function(t){return t.genre===e.genre})),n=Object(r.useState)(),i=Object(He.a)(n,2),s=i[0],l=i[1];return Object(Te.jsxs)("section",{className:"catalog catalog--like-this","data-testid":"smilar-movies",children:[Object(Te.jsx)("h2",{className:"catalog__title",children:"More like this"}),Object(Te.jsx)("div",{className:"catalog__films-list",children:a.slice(0,4).map((function(e){return Object(Te.jsx)(De,{movie:e,isActive:e===s,onMouseOver:function(){return l(e)},onMouseOut:function(){return l(null)}},e.id+1)}))})]})};var Mt=function(e){var t=e.id,c=Object(o.d)(Ge),a=Object(o.d)(lt),n=Object(Ee.g)(),i=Object(o.c)(),s=a===_?"/films/".concat(t,"/review"):"".concat(m);return Object(r.useEffect)((function(){i(function(e){return function(t,c,a){return a.get("".concat(N,"/").concat(e)).then((function(e){var c=e.data;return t(Oe(tt(c)))})).catch((function(e){return t(le(e.message))}))}}(t))}),[]),Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsxs)("section",{className:"film-card film-card--full",children:[Object(Te.jsxs)("div",{className:"film-card__hero","data-testid":"film-card-hero",children:[Object(Te.jsx)("div",{className:"film-card__bg",children:Object(Te.jsx)("img",{src:c.backgroundImage,alt:c.name})}),Object(Te.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(Te.jsxs)("header",{className:"page-header film-card__head",children:[Object(Te.jsx)(Xe,{}),Object(Te.jsx)(ot,{})]}),Object(Te.jsx)("div",{className:"film-card__wrap",children:Object(Te.jsxs)("div",{className:"film-card__desc",children:[Object(Te.jsx)("h2",{className:"film-card__title",children:c.name}),Object(Te.jsxs)("p",{className:"film-card__meta",children:[Object(Te.jsx)("span",{className:"film-card__genre",children:c.genre}),Object(Te.jsx)("span",{className:"film-card__year",children:c.released})]}),Object(Te.jsxs)("div",{className:"film-card__buttons",children:[Object(Te.jsx)(dt,{onClick:function(){return n.push("/player/".concat(t))}}),Object(Te.jsx)(jt,{movie:c}),Object(Te.jsx)(Ve.a,{to:s,className:"btn film-card__button",children:"Add review"})]})]})})]}),Object(Te.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(Te.jsxs)("div",{className:"film-card__info",children:[Object(Te.jsx)("div",{className:"film-card__poster film-card__poster--big",children:Object(Te.jsx)("img",{src:c.previewImage,alt:c.name,width:"218",height:"327"})}),Object(Te.jsx)(kt,{})]})})]}),Object(Te.jsxs)("div",{className:"page-content",children:[Object(Te.jsx)(Rt,{}),Object(Te.jsx)(Qe,{})]})]})};var Ct=function(){var e=Object(o.d)(ze).filter((function(e){return e.isFavorite})),t=Object(o.c)();return Object(r.useEffect)((function(){t(rt())}),[]),Object(Te.jsxs)("div",{className:"user-page",children:[Object(Te.jsxs)("header",{className:"page-header user-page__head",children:[Object(Te.jsx)(Xe,{}),Object(Te.jsx)("h1",{className:"page-title user-page__title",children:"My list"}),Object(Te.jsx)(ot,{})]}),Object(Te.jsxs)("section",{className:"catalog",children:[Object(Te.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(Te.jsx)(Ke,{movies:e})]}),Object(Te.jsx)(Qe,{})]})};var Ft=function(){return Object(Te.jsxs)("section",{children:[Object(Te.jsx)("h1",{children:"404. Page not found"}),Object(Te.jsx)(Ve.a,{to:b,children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"})]})};var St=function(e){var t=e.rating,c=e.onChange;return Object(Te.jsxs)(i.a.Fragment,{children:[Object(Te.jsx)("input",{className:"rating__input",id:"star-".concat(t+1),type:"radio",name:"rating",value:t+1,onChange:function(e){return c(e)}}),Object(Te.jsxs)("label",{className:"rating__label",htmlFor:"star-".concat(t+1),children:["Rating ",t+1]})]})};var qt=function(e){var t=e.id,c=Object(r.useState)({rating:null,comment:""}),a=Object(He.a)(c,2),n=a[0],i=a[1],s=Object(Ee.g)(),l=Object(o.c)(),d=function(){return!(null===n.rating||n.comment.length<C||n.comment.length>F)};function u(e){var t=e.target.name,c=e.target.value;i(Object(et.a)(Object(et.a)({},n),{},Object(j.a)({},t,c)))}var b=function(){s.goBack()};return Object(Te.jsx)("div",{className:"add-review","data-testid":"add-review-form-id",children:Object(Te.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){e.preventDefault(),l(function(e,t,c){return function(a,n,r){return r.post("".concat(k,"/").concat(e),Object(et.a)({},t)).then((function(){return a(ue(!1))})).then((function(){return c()})).catch((function(e){return a(le(e.message))}))}}(t,n,b))},disabled:!d(),children:[Object(Te.jsx)("div",{className:"rating",children:Object(Te.jsx)("div",{className:"rating__stars",children:Object(Ye.a)(Array(10).keys()).reverse().map((function(e,t){var c=e+1;return Object(Te.jsx)(St,{rating:e,onChange:u},c)}))})}),Object(Te.jsxs)("div",{className:"add-review__text",children:[Object(Te.jsx)("textarea",{className:"add-review__textarea",name:"comment",id:"review-text",placeholder:"Review text",value:n.comment,onChange:u,"data-testid":"review-textarea"}),Object(Te.jsx)("div",{className:"add-review__submit",children:Object(Te.jsx)("button",{className:"add-review__btn",type:"submit",disabled:!d(),children:"Post"})})]})]})})};var Et=function(e){var t=e.id,c=Object(o.d)(Ge);return Object(Te.jsxs)("section",{className:"film-card film-card--full",children:[Object(Te.jsxs)("div",{className:"film-card__header",children:[Object(Te.jsx)("div",{className:"film-card__bg",children:Object(Te.jsx)("img",{src:c.previewImage,alt:c.name})}),Object(Te.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(Te.jsxs)("header",{className:"page-header",children:[Object(Te.jsx)(Xe,{}),Object(Te.jsx)("nav",{className:"breadcrumbs",children:Object(Te.jsxs)("ul",{className:"breadcrumbs__list",children:[Object(Te.jsx)("li",{className:"breadcrumbs__item",children:Object(Te.jsx)(Ve.a,{to:"/films/".concat(t),className:"breadcrumbs__link",children:c.name})}),Object(Te.jsx)("li",{className:"breadcrumbs__item",children:Object(Te.jsx)(Ve.a,{to:"/films/".concat(t,"/review"),className:"breadcrumbs__link",children:"Add review"})})]})}),Object(Te.jsx)(ot,{})]}),Object(Te.jsx)("div",{className:"film-card__poster film-card__poster--small",children:Object(Te.jsx)("img",{src:c.previewImage,alt:c.name,width:"218",height:"327"})})]}),Object(Te.jsx)(qt,{id:t})]})};var It=function(e){e.id;var t=Object(o.d)(Ge),c=Object(Ee.g)(),a=Object(r.useState)(!1),n=Object(He.a)(a,2),i=n[0],s=n[1],l=Object(r.useState)(0),d=Object(He.a)(l,2),j=d[0],u=d[1],b=60*t.runTime,m=Object(r.useRef)(null),h=Object(r.useRef)(null);return Object(Te.jsxs)("div",{className:"player",ref:h,children:[Object(Te.jsx)("video",{src:t.videoLink,className:"player__video",poster:t.backgroundImage,onProgress:function(e){return u(e.target.currentTime)},muted:!1,ref:m}),Object(Te.jsx)("button",{type:"button",className:"player__exit",onClick:function(){return c.goBack()},children:"Exit"}),Object(Te.jsxs)("div",{className:"player__controls",children:[Object(Te.jsxs)("div",{className:"player__controls-row",children:[Object(Te.jsxs)("div",{className:"player__time",children:[Object(Te.jsx)("progress",{className:"player__progress",value:"".concat(j/b*100,"%"),max:"100"}),Object(Te.jsx)("div",{className:"player__toggler",style:{left:"".concat(j/b*100,"%")},children:"Toggler"})]}),Object(Te.jsx)("div",{className:"player__time-value",children:Ie(b-j)})]}),Object(Te.jsxs)("div",{className:"player__controls-row",children:[Object(Te.jsx)("button",{type:"button",className:"player__play",onClick:function(){m.current.paused||m.current.ended?(m.current.play(),s(!0)):(m.current.pause(),s(!1))},children:i?Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)("svg",{viewBox:"0 0 14 21",width:"14",height:"21",children:Object(Te.jsx)("use",{xlinkHref:"#pause"})}),Object(Te.jsx)("span",{children:"Pause"})]}):Object(Te.jsxs)(Te.Fragment,{children:[Object(Te.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(Te.jsx)("use",{xlinkHref:"#play-s"})}),Object(Te.jsx)("span",{children:"Play"})]})}),Object(Te.jsx)("div",{className:"player__name",children:t.name}),Object(Te.jsxs)("button",{type:"button",className:"player__full-screen",onClick:function(){return e=h.current,void(document.fullscreenElement?document.exitFullscreen():e.requestFullscreen&&e.requestFullscreen());var e},children:[Object(Te.jsx)("svg",{viewBox:"0 0 27 27",width:"27",height:"27",children:Object(Te.jsx)("use",{xlinkHref:"#full-screen"})}),Object(Te.jsx)("span",{children:"Full screen"})]})]})]})]})};var Ht=function(){return Object(Te.jsx)("p",{"data-testid":"loader",children:"Loading ..."})};var Lt=function(e){var t=e.render,c=e.path,a=e.exact,n=Object(o.d)(lt);return Object(Te.jsx)(Ee.b,{path:c,exact:a,render:function(e){return n===_?t(e):Object(Te.jsx)(Ee.a,{to:m})}})};var Bt=Object(o.b)((function(e){return{authorizationStatus:lt(e),isFetching:Pe(e)}}),(function(e){return{init:function(){e(function(){var e=Object(_t.a)(xt.a.mark((function e(t){return xt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(st(!0)),e.next=3,t((function(e,t,c){return c.get(R).then((function(){return e(re(_))})).catch((function(t){return e(le(t.message))}))}));case 3:return e.next=5,t(at());case 5:return e.next=7,t(nt());case 7:t(st(!1));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}}))((function(e){var t=e.authorizationStatus,c=e.isFetching,a=e.init;return Object(r.useEffect)((function(){a()}),[]),function(e){return e===p}(t)||c?Object(Te.jsx)(Ht,{}):Object(Te.jsxs)(Ee.d,{children:[Object(Te.jsx)(Ee.b,{exact:!0,path:b,render:function(){return Object(Te.jsx)(bt,{})}}),Object(Te.jsx)(Ee.b,{exact:!0,path:O,render:function(e){return Object(Te.jsx)(Mt,{id:Number(e.match.params.id)})}}),Object(Te.jsx)(Lt,{exact:!0,path:h,render:function(){return Object(Te.jsx)(Ct,{})}}),Object(Te.jsx)(Lt,{exact:!0,path:f,render:function(e){return Object(Te.jsx)(Et,{id:Number(e.match.params.id)})}}),Object(Te.jsx)(Ee.b,{exact:!0,path:v,render:function(e){return Object(Te.jsx)(It,{id:Number(e.match.params.id)})}}),Object(Te.jsx)(Ee.b,{exact:!0,path:m,render:function(){return Object(Te.jsx)(mt,{})}}),Object(Te.jsx)(Ee.b,{children:Object(Te.jsx)(Ft,{})})]})})),Vt=function(e){var t=Re.a.create({baseURL:"https://7.react.pages.academy/wtw",timeout:5e3,headers:{"x-token":Ce}});return t.interceptors.response.use((function(e){return e}),(function(t){throw t.response.status===Me&&e(),t})),t.interceptors.request.use((function(e){var t;return e.headers["x-token"]=null!==(t=localStorage.getItem("token"))&&void 0!==t?t:"",e})),t}((function(){return Tt.dispatch(re(g))})),Tt=Object(d.a)({reducer:ye,middleware:function(e){return e({thunk:{extraArgument:Vt}}).concat(qe)}});l.a.render(Object(Te.jsx)(i.a.StrictMode,{children:Object(Te.jsx)(o.a,{store:Tt,children:Object(Te.jsx)(Ee.c,{history:Se,children:Object(Te.jsx)(Bt,{})})})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.929ff364.chunk.js.map